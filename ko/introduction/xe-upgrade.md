XE 1.x에서 업그레이드
---------------------

XE 1.x로 제작된 사이트라면 비교적 간단히 라이믹스로 "업그레이드"하실 수 있습니다.
XE 코어를 업데이트할 때와 마찬가지로, 새 버전(라이믹스) 코어로 덮어씌우면 됩니다.
XE용으로 만들어진 대부분의 모듈과 애드온, 레이아웃, 위젯 등이 정상적으로 작동합니다.

### 주의사항

**XE를 라이믹스로 변환한 후에는 다시 XE로 돌아갈 수 없습니다.**

### 준비

업그레이드하기 전에 아래의 준비 과정을 거치시기 바랍니다.

 1. 설치 환경을 확인합니다. XE는 PHP 5.3 이상 버전이면 큰 문제 없이 작동하지만, 라이믹스는 PHP 7.0 이상 버전이 필요합니다.
    추가로 필요한 PHP 확장모듈도 여러 가지 있으니 XE 관리자 화면의 "서버 환경 표시" 기능을 사용하여
    [이곳](requirements.md)에 나열된 필수 확장모듈이 모두 있는지 확인하시기 바랍니다.
 2. XE 1.8 미만 버전에서 라이믹스로 직접 업그레이드하는 것은 지원하지 않습니다.
    XE 1.8 미만 버전을 사용하고 계시다면 우선 XE 1.8 이상 버전으로 업그레이드하신 후 (최신 1.11 버전을 추천합니다)
    관리자 화면에 표시되는 각종 모듈 업데이트 및 테이블 생성을 모두 마치고 나서 다시 라이믹스를 덮어씌우기 바랍니다.
 3. FTP 계정의 데이터와 DB를 각각 백업해 둡니다. DB 백업은 호스팅 업체에서 제공하는 phpmyadmin 등의 관리툴을 사용하시면 됩니다.
    호스팅 업체에서 자체 제공하는 백업 기능이나 검증되지 않은 백업 스크립트 등에 의존하지 말고,
    반드시 직접 복원할 수 있는 백업본을 확보해 두시기 바랍니다.
 4. 업그레이드를 시작하기 전에 최고관리자 계정으로 로그인하여 관리자 화면을 띄워둔 상태에서 작업하시면 안전합니다.

### 코어 덮어씌우기

[라이믹스 설치](install.md) 페이지를 참고하여 라이믹스 최신 버전을 다운로드한 후,
FTP 프로그램을 사용하여 XE가 설치된 위치에 그대로 업로드하여 기존 파일들을 덮어씁니다.

 1. 누락되거나 업로드에 실패하는 파일이 없는지 확인하시기 바랍니다.
    쉬운설치로 XE 코어를 업데이트하신 적이 있는 경우
	일부 파일의 퍼미션이 맞지 않아서 덮어쓸 수 없을 수도 있습니다.
 2. 라이믹스에는 `common/framework`, `vendor` 등 XE에서는 사용하지 않는 폴더가 여러 개 포함되어 있습니다.
    빠뜨리지 않고 모든 파일과 폴더를 100% 업로드하시기 바랍니다.

### git으로 코어 덮어씌우기 (고급/권장)

git으로 덮어씌우면 수시로 업데이트할 수 있고, master와 develop을 자유롭게 전환할 수 있다는 장점이 있습니다.
단, 서버에 git과 rsync가 설치되어 있어야 하며 SSH(터미널) 접속이 가능해야 합니다.

우선 XE가 설치된 폴더(`www`, `public_html` 등) **바깥에** 임시 폴더를 생성하여
git으로 라이믹스를 다운로드합니다.

    cd ..
    git clone https://github.com/rhymix/rhymix.git

임시 폴더에 다운로드된 라이믹스를 XE가 설치된 폴더에 덮어씌웁니다.
(`www` 폴더명을 실제 폴더명으로 변경하십시오. 각 폴더명 뒤에 반드시 슬래시(`/`)를 넣어야 합니다.)

    rsync -av rhymix/ www/

동기화가 끝나면 임시 폴더에 설치한 라이믹스는 삭제하셔도 됩니다.
(`rm -rf`는 매우 위험한 명령이므로 현재 경로와 삭제할 경로가 정확한지 여러 차례 확인하시기 바랍니다.)

    rm -rf rhymix/

### 마이그레이션 툴 관련 안내

XE에서 XE로, XE에서 라이믹스로, 라이믹스에서 라이믹스로 업그레이드하는 어떤 과정에서도
마이그레이션 툴을 사용하는 것은 권장하지 않습니다.
과거에 XE에서 배포한 마이그레이션 툴은 안정성과 호환성이 무척 떨어지며, 자료가 안전하게 옮겨진다고 보장할 수 없습니다.

라이믹스를 먼저 설치한 후 XE의 DB를 덮어씌우는 것 역시 권장하지 않습니다.
위에서 설명하였듯이, 코어를 업그레이드하는 가장 정상적인 방법은 기존 버전 위에 새 버전을 덮어씌우는 것입니다.

### 모듈 업데이트

모든 파일을 업로드한 후 관리자 화면을 새로고침하면 `comment`, `member` 등
코어에 포함된 여러 모듈들을 업데이트하거나 테이블을 생성하라는 메시지가 표시될 것입니다.
하나도 빠짐없이 모두 클릭하여 업데이트 및 테이블 생성을 마쳐 주시기 바랍니다.

### 캐시파일 재생성

모든 업데이트를 마친 후 "캐시파일 재생성"을 클릭해 주십시오.
만약 지나치게 긴 시간이 걸리거나 캐시파일 재생성에 실패하는 경우
FTP를 사용해서 `files/cache` 폴더 아래의 내용을 모두 삭제하셔도 무방합니다.
(XE와 달리 캐시파일 수동 삭제시에도 메뉴 사라짐 현상 등이 발생하지 않습니다.)

### 각종 설정 점검

"설정" → "시스템 설정" (XE에서는 "기본 설정") 화면이 대폭 강화되었습니다.
사이트 설정, 보안 설정, 그 밖의 각종 설정들이 원하시는 상태로 되어 있는지 확인하시기 바랍니다.

### 서드파티 자료 점검

[서드파티 자료 호환성 체크리스트](thirdparty-checklist.md) 페이지를 참고하여
기존 설정이 제대로 변환되었는지 확인하시고,
서드파티 자료에서 제공하던 기능이 라이믹스에 흡수된 경우
라이믹스에 추가된 옵션을 사용하여 해당 기능을 다시 활성화시키셔야 할 수도 있습니다.

### 불필요한 폴더 삭제

XE에 포함되어 있던 아래의 폴더들은 라이믹스에서는 더이상 필요하지 않으므로 삭제하셔도 무방합니다.
단, 기존 경로에 의존하는 서드파티 자료가 있을 수도 있으니, 별도로 설치하신 모듈이나 애드온 등이 많다면
그대로 두시기를 권장합니다.

  - `admin` (불필요)
  - `classes/security/conf` (불필요)
  - `classes/security/htmlpurifier` (다른 경로로 옮겼음)
  - `classes/security/phphtmlparser` (다른 경로로 옮겼음)
  - `common/xeicon` (다른 경로로 옮겼음)
  - `doxygen` (불필요)
  - `libs` (다른 경로로 옮겼음)
  - `modules/editor/skins/xpresseditor` (CKEditor로 대체됨)
